# 12.04.2024

# ОС/Лекция 8

# Файловые системы

Первая абстракция ОС связана с вычислительными ресурсами. Вторая - с оперативной памятью. Третья (которая рассматривается в этой лекции) - с постоянной памятью.

Самыми распространёнными устройствами долговременного хранения данных являются:
- HDD 3.5''
- SSD 2.5''
- SSD M2

Главная особенность жёсткого диска (HDD) в том, что это мехническое уст-во.

Долговременная память также может быть представлена в виде:
- дискет
- компакт-дисков
- флеш-накопителей
- карт памяти различного форм фактора.

Универсальной абстракцией долговременной памяти является <u>файловая система</u>.

Известные файловые системы:
- FAT (File Allocation Table);
- NTFS (New Technology File System);
- ReFS (Resilient File System);
- ext (Extended File System);
- ZFS (Zettabyte File System);
- BTRFS (B-Tree File System);
- APFS (Apple File System);
- Optical Disks (ISO 9660, UDF).

## Файл

Файл - базовая единица любой файловой системы.

ОС управляет файлами:
- структура файлов;
- имена файлов;
- доступ;
- использование;
- защита;
- реализация;
- управления.

Правила именования файлов варьируются от одной файловой системы к другой:
- ASCII, Unicode;
- чувствительность к регистру;
- ограничения на длину имени, длину пути;

Универсальный почти для всех ОС формат:

<ИМЯ_ФАЙЛА>.<РАСШИРЕНИЕ>

Типы файлов:

Для всех ОС:
- Обычные файлы
	- текстовые
	- двоичные
- Каталоги

UNIX/UNIX-like:
- символьные спец. файлы;
- блочные спец. файлы.

Символьный означает, что устройство, абстракцией которого является файл, будет читать/писать по одному символу. Блочный в свою очередь будет читать/писать блоками данных (чанками).

## Двоичные файлы

[Структура двоичных файлов](../assets/suai_os_binary_files_structure.jpg)

Помимо самих данных файловая система хранит доп. информацию о файлах:
- защита (кто и каким образом может получить доступ к файлу);
- пароль;
- создатель;
- владелец;
- флаг "только для чтения";
- флаг "скрытый";
...

## Работа с файлами

Доступ к файлам:
- последовательный;
- параллельный

Системные вызовы:

## Структура файловой системы

Есть два подхода к структуре файловой системы и разметке жёсткого диска (наиболее широко используемый).

1. MBR - схема разметки жёсткого диска, основанная на Главной Загрузочной Записи (Master Boot Record). Можно создать до четырёх разделов на одном диске. Такое жёсткое ограничение обусловлено тем, что таблица разделов (идёт сразу после MBR в разметке) содержит всего четыре записи.

Способы размещения файлов на диске:
1. Непрерывное размещение блоков;
2. Размещение с использованием связного списка (нет фрагментации: легко удалять и добавлять; проблема в том, что нужно взять кусочек блока для указателя, а оставшаяся часть будет не кратна степени двойки, что затруднит операции чтения/записи, так как многие устройства работают основываясь на степенях двойки);
3. Таблица блоков
4. Индексные узлы (i-nodex, i-узлы, index-nodes) Индексы - это отдельные блоки, которые не содержат данных, а содержат информацию о том, как хранятся файлы и ссылки на блоки + ссылка на блок диска с дополнительными индексными узлами для хранения файлов большого размера.




